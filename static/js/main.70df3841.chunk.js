(this["webpackJsonpbook-search"]=this["webpackJsonpbook-search"]||[]).push([[0],{2:function(e,t,o){e.exports={overlay:"Modal_overlay__1TgzI",show:"Modal_show__1k4KI",closeModalBtn:"Modal_closeModalBtn__3ingD",bookData:"Modal_bookData__2rRut",bookData__cover:"Modal_bookData__cover__1HcMf",bookData__cover_placeholder:"Modal_bookData__cover_placeholder__3M3nF",bookData__info_title:"Modal_bookData__info_title__20AKR",bookData__info_author:"Modal_bookData__info_author__2AY8b",bookData__info_additional:"Modal_bookData__info_additional__2QYKT",bookData__info_addTitle:"Modal_bookData__info_addTitle__3TwEa",bookData__info_addValue:"Modal_bookData__info_addValue__31WWg"}},34:function(e,t,o){},35:function(e,t,o){},36:function(e,t,o){"use strict";o.r(t);var a,c=o(1),n=o.n(c),s=o(9),r=o.n(s),_=o(4),i=o(7),l=o(17),u=o(18),b=o(14),d=o(3),O={offset:0,limit:10,books:[],showLoader:!1,booksNotFound:!1,selectedBook:null,lastSearch:"",error:null};!function(e){e.SET_OFFSET="SET_OFFSET",e.STORE_REQUEST="STORE_REQUEST",e.FETCH_BOOKS_START="FETCH_BOOKS_START",e.FETCH_BOOKS_SUCCESS="FETCH_BOOKS_SUCCESS",e.FETCH_BOOKS_FAILURE="FETCH_BOOKS_FAILURE",e.CLEAR_BOOKS="CLEAR_BOOKS",e.BOOKS_NOT_FOUND="BOOKS_NOT_FOUND",e.SELECT_BOOK="SELECT_BOOK"}(a||(a={}));var j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.SET_OFFSET:return Object(d.a)(Object(d.a)({},e),{},{offset:t.payload});case a.FETCH_BOOKS_START:return Object(d.a)(Object(d.a)({},e),{},{booksNotFound:!1,showLoader:!0,error:null});case a.BOOKS_NOT_FOUND:return Object(d.a)(Object(d.a)({},e),{},{booksNotFound:!0,showLoader:!1});case a.FETCH_BOOKS_SUCCESS:return 0===e.offset?Object(d.a)(Object(d.a)({},e),{},{books:t.payload,showLoader:!1}):Object(d.a)(Object(d.a)({},e),{},{books:[].concat(Object(b.a)(e.books),Object(b.a)(t.payload)),showLoader:!1});case a.FETCH_BOOKS_FAILURE:return Object(d.a)(Object(d.a)({},e),{},{showLoader:!1,error:t.payload});case a.CLEAR_BOOKS:return Object(d.a)(Object(d.a)({},e),{},{booksNotFound:!1,showLoader:!1,books:[]});case a.SELECT_BOOK:return Object(d.a)(Object(d.a)({},e),{},{selectedBook:t.payload});case a.STORE_REQUEST:return Object(d.a)(Object(d.a)({},e),{},{lastSearch:t.payload});default:return e}},h=Object(i.createStore)(j,Object(l.composeWithDevTools)(Object(i.applyMiddleware)(u.a))),f=_.c,p=o(13),k=o.n(p),m=o(19),v=function e(){if(document.documentElement.getBoundingClientRect().bottom<document.documentElement.clientHeight+1){var t=h.getState().offset,o=h.getState().limit;h.dispatch(E(t+o)),document.removeEventListener("scroll",e)}},E=function(e){return{type:a.SET_OFFSET,payload:e}},S=function(e){return{type:a.SELECT_BOOK,payload:e}},x=function(e){return function(){var t=Object(m.a)(k.a.mark((function t(o,c){var n,s,r,_;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.split(" ").join("+"),s=c().offset,r=c().lastSearch,t.prev=3,!e.trim()||e===r&&0===s){t.next=13;break}return o({type:a.FETCH_BOOKS_START}),t.next=8,fetch("https://openlibrary.org/search.json?title=".concat(n,"&limit=10&offset=").concat(s)).then((function(e){return e.json()}));case 8:0===(_=t.sent).docs.length&&0===c().books.length?o((b=!0,{type:a.BOOKS_NOT_FOUND,payload:b})):o((u=_.docs,{type:a.FETCH_BOOKS_SUCCESS,payload:u})),_.docs.length>0&&document.addEventListener("scroll",v),t.next=18;break;case 13:if(e.trim()){t.next=17;break}o({type:a.CLEAR_BOOKS}),t.next=18;break;case 17:return t.abrupt("return");case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(3),o((l=t.t0,{type:a.FETCH_BOOKS_FAILURE,payload:l}));case 23:o((i=e,{type:a.STORE_REQUEST,payload:i}));case 24:case"end":return t.stop()}var i,l,u,b}),t,null,[[3,20]])})));return function(e,o){return t.apply(this,arguments)}}()},T=o(6),N=o.n(T),B=o(0),g=function(e){var t=e.book,o=Object(_.b)(),a=function(e){" "!==e.key&&"Enter"!==e.key||e.currentTarget.click()};return Object(B.jsxs)("div",{className:N.a.book,onClick:function(){return o(S(t))},tabIndex:0,onFocus:function(e){e.currentTarget.addEventListener("keypress",a)},onBlur:function(e){e.currentTarget.removeEventListener("keypress",a)},children:[t.cover_i&&"-1"!==t.cover_i[0]?Object(B.jsx)("img",{className:N.a.book__cover,src:"https://covers.openlibrary.org/b/id/".concat(t.cover_i,"-M.jpg"),alt:"".concat(t.title," cover")}):Object(B.jsx)("div",{className:"".concat(N.a.book__cover_placeholder," ").concat(N.a.book__cover)}),Object(B.jsxs)("div",{className:N.a.book__info,children:[Object(B.jsx)("h2",{className:N.a.book__info_title,children:t.title}),Object(B.jsx)("hr",{}),Object(B.jsx)("h4",{className:N.a.book__info_authors,children:Array.isArray(t.author_name)?t.author_name.join(", "):t.author_name})]})]})},y=o(2),D=o.n(y),F=function(){var e,t=f((function(e){return e.selectedBook})),o=Object(_.b)(),a=Object(c.useRef)(null),n=Object(c.useRef)(null),s=function(){a.current.classList.remove(D.a.show),setTimeout((function(){return o(S(null))}),600)};return Object(c.useEffect)((function(){a.current.classList.add(D.a.show),n.current.focus()}),[]),Object(B.jsx)("div",{ref:a,className:D.a.overlay,onClick:s,children:Object(B.jsxs)("main",{ref:n,className:D.a.bookData,onClick:function(e){return e.stopPropagation()},tabIndex:1,children:[Object(B.jsx)("button",{className:D.a.closeModalBtn,onClick:s,tabIndex:1,children:"\xd7"}),t.cover_i&&"-1"!==t.cover_i[0]?Object(B.jsx)("img",{className:D.a.bookData__cover,src:"https://covers.openlibrary.org/b/id/".concat(t.cover_i,"-L.jpg"),alt:"".concat(t.title," cover")}):Object(B.jsx)("div",{className:"".concat(D.a.bookData__cover_placeholder," ").concat(D.a.bookData__cover)}),Object(B.jsxs)("div",{className:D.a.bookData__info,children:[Object(B.jsx)("h2",{className:D.a.bookData__info_title,children:t.title}),Object(B.jsx)("p",{className:D.a.bookData__info_author,children:t.author_name.length>1?Object(B.jsxs)(B.Fragment,{children:["\u0410\u0432\u0442\u043e\u0440\u044b: ",Object(B.jsx)("b",{children:t.author_name.join(", ")})]}):Object(B.jsxs)(B.Fragment,{children:["\u0410\u0432\u0442\u043e\u0440: ",Object(B.jsx)("b",{children:t.author_name})]})}),Object(B.jsxs)("div",{className:D.a.bookData__info_additional,children:[Object(B.jsx)("b",{className:D.a.bookData__info_addTitle,children:"\u0414\u0430\u0442\u0430 \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u0438:"}),Object(B.jsx)("span",{className:D.a.bookData__info_addValue,children:t.publish_date?t.publish_date[0]:"\u0414\u0430\u0442\u0430 \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u0438 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0431\u0430\u0437\u0435"})]}),Object(B.jsxs)("div",{className:D.a.bookData__info_additional,children:[Object(B.jsx)("b",{className:D.a.bookData__info_addTitle,children:"\u0418\u0437\u0434\u0430\u0442\u0435\u043b\u044c:"}),Object(B.jsx)("span",{className:D.a.bookData__info_addValue,children:t.publisher?t.publisher[0]:"\u0421\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043e\u0431 \u0438\u0437\u0434\u0430\u0442\u0435\u043b\u0435 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0432 \u0431\u0430\u0437\u0435"})]}),Object(B.jsxs)("div",{className:D.a.bookData__info_additional,children:[Object(B.jsx)("b",{className:D.a.bookData__info_addTitle,children:"ISBN:"}),Object(B.jsx)("span",{className:D.a.bookData__info_addValue,children:t.isbn?(e=t.isbn[0],13===e.length?"".concat(e.slice(0,3),"-").concat(e[3],"-").concat(e.slice(4,8),"-").concat(e.slice(8,12),"-").concat(e[12]):10===e.length?"".concat(e[0],"-").concat(e.slice(1,5),"-").concat(e.slice(5,9),"-").concat(e[9]):e):"ISBN \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0431\u0430\u0437\u0435"})]})]})]})})},C=o(8),L=o.n(C),K=function(){var e=Object(c.useRef)(null);Object(c.useEffect)((function(){e.current.classList.add(L.a.show),setTimeout((function(){e.current.classList.remove(L.a.show)}),3e3)}),[]);var t=f((function(e){var t,o;return null!==(t=null===(o=e.error)||void 0===o?void 0:o.message)&&void 0!==t?t:"\u041d\u0435\u043f\u0440\u0435\u0434\u0432\u0438\u0434\u0435\u043d\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430. \u041f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443, \u0438\u043b\u0438 \u043f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435..."}));return Object(B.jsx)("div",{className:L.a.popup,ref:e,children:Object(B.jsx)("strong",{className:L.a.message,children:t})})},R=(o(34),function(){return Object(B.jsxs)("div",{className:"lds-ring",children:[Object(B.jsx)("div",{}),Object(B.jsx)("div",{}),Object(B.jsx)("div",{}),Object(B.jsx)("div",{})]})});var w=function(e,t){var o=setTimeout(e,t);this.stop=function(){return o&&(clearTimeout(o),o=null),this},this.start=function(){return o||(this.stop(),o=setTimeout(e,t)),this},this.reset=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t;return t=e,this.stop().start()}},A=o(5),M=o.n(A),I=function(){var e=f((function(e){return e.offset})),t=f((function(e){return e.books})),o=f((function(e){return e.lastSearch})),a=f((function(e){return e.showLoader})),n=f((function(e){var t;return null!==(t=e.error)&&void 0!==t&&t})),s=f((function(e){return e.booksNotFound})),r=f((function(e){return e.selectedBook})),i=Object(_.b)(),l=Object(c.useRef)(null),u=Object(c.useRef)(null),b=new w((function(){i(x(l.current.value))}),1e3);b.stop();var d=Object(c.useCallback)((function(){0===e&&l.current.value.trim()===o||b.reset()}),[e,o]);return Object(c.useEffect)((function(){document.removeEventListener("scroll",v),d()}),[e,d]),Object(c.useEffect)((function(){0===t.length&&u.current.classList.add("".concat(M.a.show))}),[t]),Object(B.jsxs)("div",{className:M.a.app,children:[n&&Object(B.jsx)(K,{}),r&&Object(B.jsx)(F,{}),Object(B.jsx)("h1",{className:M.a.title,children:"\u041a\u043d\u0438\u0433\u0438"}),Object(B.jsxs)("div",{className:M.a.search,children:[Object(B.jsx)("input",{className:M.a.search__input,type:"text",onChange:function(t){0!==e&&i(E(0)),b.reset()},placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043a\u043d\u0438\u0433\u0438",ref:l}),Object(B.jsx)("button",{className:M.a.search__button,onClick:function(){b.stop(),i(x(l.current.value))},children:"\u041d\u0430\u0439\u0442\u0438"})]}),0===t.length&&Object(B.jsxs)("small",{id:"disclaimer",className:M.a.disclaimer,ref:u,children:["\u0422\u0430\u043a \u043a\u0430\u043a API \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u0440\u0443\u0441\u0441\u043a\u0438\u0439 \u044f\u0437\u044b\u043a, \u0434\u043b\u044f \u043f\u043e\u0438\u0441\u043a\u0430 \u043a\u043d\u0438\u0433\u0438 \u0432\u0432\u043e\u0434\u0438\u0442\u0435 \u0435\u0451 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0442\u0440\u0430\u043d\u0441\u043b\u0438\u0442\u043e\u043c, \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 ",Object(B.jsx)("b",{children:'"Ponedel\'nik nachinaetsya v subbotu"'})]}),a&&0===t.length&&Object(B.jsx)(R,{}),s?Object(B.jsx)("p",{className:M.a.noBooks,children:"\u041a \u0441\u043e\u0436\u0430\u043b\u0435\u043d\u0438\u044e, \u043f\u043e \u0432\u0430\u0448\u0435\u043c\u0443 \u0437\u0430\u043f\u0440\u043e\u0441\u0443 \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0430\u0439\u0442\u0438 \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c"}):Object(B.jsx)("div",{className:"books",children:t.map((function(e){return Object(B.jsx)(g,{book:e},e.key)}))})]})};o(35);r.a.render(Object(B.jsx)(n.a.StrictMode,{children:Object(B.jsx)(_.a,{store:h,children:Object(B.jsx)(I,{})})}),document.getElementById("root"))},5:function(e,t,o){e.exports={app:"App_app__3BT4Y",title:"App_title__2C-7r",search:"App_search__2Y1TS",search__input:"App_search__input__8eVFo",search__button:"App_search__button__1HI-h",disclaimer:"App_disclaimer__2Szu9",show:"App_show__3q8px",noBooks:"App_noBooks__2fhmZ"}},6:function(e,t,o){e.exports={book:"BookItem_book__1P0te",book__cover:"BookItem_book__cover__YGfPK",book__cover_placeholder:"BookItem_book__cover_placeholder__3RQcP",book__info_title:"BookItem_book__info_title__1GSOz",book__info_authors:"BookItem_book__info_authors__8_lfg"}},8:function(e,t,o){e.exports={popup:"ErrPopup_popup__3Vo8r",message:"ErrPopup_message__29wVz",show:"ErrPopup_show__3KE3M"}}},[[36,1,2]]]);
//# sourceMappingURL=main.70df3841.chunk.js.map