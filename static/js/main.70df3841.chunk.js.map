{"version":3,"sources":["components/Modal/Modal.module.scss","store/actions.ts","store/initialState.ts","store/reducer.ts","store/store.ts","utils/useTypedSelector.ts","utils/infiniteScroll.ts","store/actionCreators.ts","components/BookItem/BookItem.tsx","components/Modal/Modal.tsx","components/ErrPopup/ErrPopup.tsx","components/Loader/Loader.js","utils/timer.js","components/App/App.tsx","index.js","components/App/App.module.scss","components/BookItem/BookItem.module.scss","components/ErrPopup/ErrPopup.module.scss"],"names":["module","exports","actionType","initialState","offset","limit","books","showLoader","booksNotFound","selectedBook","lastSearch","error","reducer","state","action","type","SET_OFFSET","payload","FETCH_BOOKS_START","BOOKS_NOT_FOUND","FETCH_BOOKS_SUCCESS","FETCH_BOOKS_FAILURE","CLEAR_BOOKS","SELECT_BOOK","STORE_REQUEST","store","createStore","composeWithDevTools","applyMiddleware","thunk","useTypedSelector","useSelector","addInfScroll","document","documentElement","getBoundingClientRect","bottom","clientHeight","currentOffset","getState","dispatch","setOffset","removeEventListener","setCurrentBook","book","fetchBooks","search","a","requestParam","split","join","trim","fetch","then","response","json","docs","length","addEventListener","request","BookItem","useDispatch","openBookByKeyboard","evt","key","currentTarget","click","className","styles","onClick","tabIndex","onFocus","onBlur","cover_i","book__cover","src","alt","title","book__cover_placeholder","book__info","book__info_title","book__info_authors","Array","isArray","author_name","Modal","isbn","overlay","useRef","modal","closeModal","current","classList","remove","show","setTimeout","useEffect","add","focus","ref","bookData","e","stopPropagation","closeModalBtn","bookData__cover","bookData__cover_placeholder","bookData__info","bookData__info_title","bookData__info_author","bookData__info_additional","bookData__info_addTitle","bookData__info_addValue","publish_date","publisher","slice","ErrPopup","errorPopup","message","popup","Loader","Timer","fn","t","timerObj","this","stop","clearTimeout","start","reset","newT","App","isLoading","isError","notFoundMessage","searchInput","disclaimer","timer","value","memoizedFetch","useCallback","app","search__input","onChange","placeholder","search__button","id","noBooks","map","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.70df3841.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"overlay\":\"Modal_overlay__1TgzI\",\"show\":\"Modal_show__1k4KI\",\"closeModalBtn\":\"Modal_closeModalBtn__3ingD\",\"bookData\":\"Modal_bookData__2rRut\",\"bookData__cover\":\"Modal_bookData__cover__1HcMf\",\"bookData__cover_placeholder\":\"Modal_bookData__cover_placeholder__3M3nF\",\"bookData__info_title\":\"Modal_bookData__info_title__20AKR\",\"bookData__info_author\":\"Modal_bookData__info_author__2AY8b\",\"bookData__info_additional\":\"Modal_bookData__info_additional__2QYKT\",\"bookData__info_addTitle\":\"Modal_bookData__info_addTitle__3TwEa\",\"bookData__info_addValue\":\"Modal_bookData__info_addValue__31WWg\"};","export enum actionType {\n  SET_OFFSET = \"SET_OFFSET\",\n  STORE_REQUEST = \"STORE_REQUEST\",\n\n  FETCH_BOOKS_START = \"FETCH_BOOKS_START\",\n  FETCH_BOOKS_SUCCESS = \"FETCH_BOOKS_SUCCESS\",\n  FETCH_BOOKS_FAILURE = \"FETCH_BOOKS_FAILURE\",\n  CLEAR_BOOKS = \"CLEAR_BOOKS\",\n\n  BOOKS_NOT_FOUND = \"BOOKS_NOT_FOUND\",\n  SELECT_BOOK = \"SELECT_BOOK\",\n}\n","import { storeInterface } from './types'\n\nconst initialState: storeInterface = {\n  offset: 0,\n  limit: 10,\n  books: [],\n  showLoader: false,\n  booksNotFound: false,\n  selectedBook: null,\n  lastSearch: '',\n  error: null,\n}\n\nexport default initialState\n","import initialState from './initialState'\nimport { actionType } from './actions'\nimport { storeInterface, action } from './types'\n\n// import { SET_OFFSET, STORE_REQUEST } from './actions'\n// import { FETCH_BOOKS_START, FETCH_BOOKS_SUCCESS, FETCH_BOOKS_FAILURE, CLEAR_BOOKS } from './actions'\n// import { BOOKS_NOT_FOUND, SELECT_BOOK } from './actions'\n\nconst reducer = (state: storeInterface = initialState, action: action) => {\n  \n  switch (action.type) {\n    case actionType.SET_OFFSET:\n      return {\n        ...state,\n        offset: action.payload,\n      }\n\n    case actionType.FETCH_BOOKS_START:\n      return {\n        ...state,\n        booksNotFound: false,\n        showLoader: true,\n        error: null,\n      }\n\n    case actionType.BOOKS_NOT_FOUND:\n      return {\n        ...state,\n        booksNotFound: true,\n        showLoader: false,\n      }\n    \n    case actionType.FETCH_BOOKS_SUCCESS:\n      if (state.offset === 0 ) {\n        return {\n          ...state,\n          books: action.payload,\n          showLoader: false,\n        }\n      } else {\n        return {\n          ...state,\n          books: [\n            ...state.books,\n            ...action.payload,\n          ],\n          showLoader: false,\n        }\n      }\n      \n\n    case actionType.FETCH_BOOKS_FAILURE:\n      return {\n        ...state,\n        showLoader: false,\n        error: action.payload,\n      }\n\n    case actionType.CLEAR_BOOKS:\n      return {\n        ...state,\n        booksNotFound: false,\n        showLoader: false,\n        books: [],\n      }\n\n    case actionType.SELECT_BOOK:\n      return {\n        ...state,\n        selectedBook: action.payload,\n      }\n\n    case actionType.STORE_REQUEST:\n      return {\n        ...state,\n        lastSearch: action.payload,\n      }\n  \n    default:\n      return state\n  }\n}\n\nexport default reducer\n","import { createStore, applyMiddleware } from 'redux'\nimport { composeWithDevTools } from 'redux-devtools-extension'\nimport thunk from 'redux-thunk'\nimport reducer from './reducer'\n\nconst store = createStore(reducer, composeWithDevTools(applyMiddleware(thunk)))\n\nexport default store\n","import { TypedUseSelectorHook, useSelector } from 'react-redux'\nimport state from '../store/reducer'\n\ntype stateType = ReturnType<typeof state>\n\nexport const useTypedSelector: TypedUseSelectorHook<stateType> = useSelector\n","import { setOffset } from '../store/actionCreators'\nimport store from '../store/store'\n\nconst addInfScroll = () => {\n  let windowRelativeBottom = document.documentElement.getBoundingClientRect().bottom\n  if (windowRelativeBottom < document.documentElement.clientHeight + 1) {\n    const currentOffset = store.getState().offset\n    const limit = store.getState().limit\n\n    store.dispatch(setOffset(currentOffset + limit))\n    document.removeEventListener('scroll', addInfScroll)\n  }\n}\n\nexport default addInfScroll\n","import { actionType } from './actions'\nimport { action, storeInterface, bookInterface } from './types'\nimport addInfScroll from '../utils/infiniteScroll'\nimport { ThunkAction } from 'redux-thunk'\n\nexport const setOffset = (offset: number): action => {\n  return {\n    type: actionType.SET_OFFSET,\n    payload: offset,\n  }\n}\n\nexport const requestBooks = (): action => {\n  return {\n    type: actionType.FETCH_BOOKS_START,\n  }\n}\n\nexport const requestBooksSuccess = (books: bookInterface[]): action => {\n  return {\n    type: actionType.FETCH_BOOKS_SUCCESS,\n    payload: books,\n  }\n}\n\nexport const requestBooksFailure = (error: Error): action => {\n  return {\n    type: actionType.FETCH_BOOKS_FAILURE,\n    payload: error,\n  }\n}\n\nexport const clearBooksList = (): action => {\n  return {\n    type: actionType.CLEAR_BOOKS,\n  }\n}\n\nexport const setNotFoundMessage = (state: boolean): action => {\n  return {\n    type: actionType.BOOKS_NOT_FOUND,\n    payload: state,\n  }\n}\n\nexport const setCurrentBook = (book: bookInterface | null): action => {\n  return {\n    type: actionType.SELECT_BOOK,\n    payload: book,\n  }\n}\n\nexport const storeLastRequest = (request: string): action => {\n  return {\n    type: actionType.STORE_REQUEST,\n    payload: request,\n  }\n}\n\n// async\n\nexport const fetchBooks = (search: string): ThunkAction<void, storeInterface, unknown, action> => {\n  return async (dispatch, getState) => {\n    const requestParam = search.split(' ').join('+')\n    const offset = getState().offset\n    const lastSearch = getState().lastSearch\n\n    try {\n      if (search.trim() && (search !== lastSearch || offset !== 0)) {\n        dispatch(requestBooks())\n        const response = await fetch(`https://openlibrary.org/search.json?title=${requestParam}&limit=10&offset=${offset}`)\n          .then(response => response.json())\n        if (response.docs.length === 0 && getState().books.length === 0) {\n          dispatch(setNotFoundMessage(true))\n        } else {\n          dispatch(requestBooksSuccess(response.docs))\n        }\n        if (response.docs.length > 0) document.addEventListener('scroll', addInfScroll)\n      } else if (!search.trim()) {\n        dispatch(clearBooksList())\n      } else return\n    } catch (err) {\n      dispatch(requestBooksFailure(err))\n    }\n    dispatch(storeLastRequest(search))\n  }\n}\n","import React from 'react'\nimport { useDispatch } from 'react-redux' \nimport { setCurrentBook } from '../../store/actionCreators'\nimport { bookInterface } from '../../store/types'\nimport styles from './BookItem.module.scss'\n\ntype BookItemProps = {\n  book: bookInterface\n}\n\nconst BookItem: React.FC<BookItemProps> = ({ book }) => {\n\n  const dispatch = useDispatch()\n\n  const openBookByKeyboard = (evt: KeyboardEvent): void => {\n    if (evt.key === ' ' || evt.key === 'Enter') {\n      const target: HTMLElement = evt.currentTarget as HTMLElement\n      target.click();\n    }\n  } \n\n  const focusBookHandler = (evt: React.FocusEvent): void => {\n    const target: HTMLElement = evt.currentTarget as HTMLElement\n    target.addEventListener('keypress', openBookByKeyboard)\n  }\n\n  const blurBookHandler = (evt: React.FocusEvent): void => {\n    const target: HTMLElement = evt.currentTarget as HTMLElement\n    target.removeEventListener('keypress', openBookByKeyboard)\n  }\n\n  return (\n    <div\n      className={styles.book}\n      onClick={() => dispatch(setCurrentBook(book))}\n      tabIndex={0}\n      onFocus={focusBookHandler}\n      onBlur={blurBookHandler}\n    >\n    {book.cover_i && book.cover_i[0] !== '-1'\n      ? <img\n        className={styles.book__cover}\n        src={`https://covers.openlibrary.org/b/id/${book.cover_i}-M.jpg`}\n        alt={`${book.title} cover`}\n      />\n      : <div className={`${styles.book__cover_placeholder} ${styles.book__cover}`} />\n    }\n    <div className={styles.book__info}>\n      <h2 className={styles.book__info_title}>{book.title}</h2>\n      <hr />\n      <h4 className={styles.book__info_authors}>\n        {Array.isArray(book.author_name)\n          ? book.author_name.join(', ')\n          : book.author_name\n        }\n      </h4>\n    </div>\n  </div>\n  )\n}\n\nexport default BookItem\n","import React, { useEffect, useRef } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { useTypedSelector } from '../../utils/useTypedSelector'\nimport { setCurrentBook } from '../../store/actionCreators'\nimport styles from './Modal.module.scss'\n\nconst Modal: React.FC = () => {\n  const book = useTypedSelector(state => state.selectedBook)\n  const dispatch = useDispatch()\n\n  const overlay = useRef<HTMLDivElement | null>(null)\n  const modal = useRef<HTMLDivElement | null>(null)\n\n  const formatIsbn = (isbn: string): string => {\n    if (isbn.length === 13) {\n      return `${isbn.slice(0, 3)}-${isbn[3]}-${isbn.slice(4, 8)}-${isbn.slice(8, 12)}-${isbn[12]}`\n    } else if (isbn.length === 10) {\n      return `${isbn[0]}-${isbn.slice(1, 5)}-${isbn.slice(5, 9)}-${isbn[9]}`\n    } else return isbn\n  }\n\n  const closeModal = () => {\n    overlay.current!.classList.remove(styles.show)\n\n    setTimeout(() => dispatch(setCurrentBook(null)), 600)\n  }\n\n  useEffect(() => {\n    overlay.current!.classList.add(styles.show)\n\n    modal.current!.focus()\n  }, [])\n\n  return (\n    <div ref={overlay} className={styles.overlay} onClick={closeModal}>\n      <main ref={modal} className={styles.bookData} onClick={e => e.stopPropagation()} tabIndex={1}>\n      <button\n        className={styles.closeModalBtn}\n        onClick={closeModal}\n        tabIndex={1}\n      >\n        &times;\n      </button>\n        {book!.cover_i && book!.cover_i[0] !== '-1'\n          ? <img\n            className={styles.bookData__cover}\n            src={`https://covers.openlibrary.org/b/id/${book!.cover_i}-L.jpg`}\n            alt={`${book!.title} cover`}\n          />\n          : <div className={`${styles.bookData__cover_placeholder} ${styles.bookData__cover}`} />\n        }\n        <div className={styles.bookData__info}>\n          <h2 className={styles.bookData__info_title}>\n            {book!.title}\n          </h2>\n          <p className={styles.bookData__info_author}>\n            {book!.author_name.length > 1\n              ? <>Авторы: <b>{book!.author_name.join(', ')}</b></>\n              : <>Автор: <b>{book!.author_name}</b></>\n            }\n          </p>\n          <div className={styles.bookData__info_additional}>\n            <b className={styles.bookData__info_addTitle}>Дата публикации:</b>\n            <span className={styles.bookData__info_addValue}>\n              {book!.publish_date ? book!.publish_date[0] : 'Дата публикации отсутствует в базе'}\n            </span>\n          </div>\n          <div className={styles.bookData__info_additional}>\n            <b className={styles.bookData__info_addTitle}>Издатель:</b>\n            <span className={styles.bookData__info_addValue}>\n              {book!.publisher ? book!.publisher[0] : 'Сведения об издателе отсутствуют в базе'}\n            </span>\n          </div>\n          <div className={styles.bookData__info_additional}>\n            <b className={styles.bookData__info_addTitle}>ISBN:</b>\n            <span className={styles.bookData__info_addValue}>\n              {book!.isbn? formatIsbn(book!.isbn[0]) : 'ISBN отсутствует в базе'}\n            </span>\n          </div>\n        </div>\n      </main>\n    </div>\n  )\n}\n\nexport default Modal\n","import React, { useEffect, useRef } from 'react'\nimport { useTypedSelector } from '../../utils/useTypedSelector'\nimport styles from './ErrPopup.module.scss'\n\nconst ErrPopup: React.FC = () => {\n\n  const errorPopup = useRef<HTMLDivElement | null>(null)\n\n  useEffect(() => {\n    errorPopup.current!.classList.add(styles.show)\n    setTimeout(() => {\n      errorPopup.current!.classList.remove(styles.show)\n    }, 3000)\n  }, [])\n\n  const message = useTypedSelector(state => state.error?.message ?? \"Непредвиденная ошибка. Перезагрузите страницу, или попробуйте позже...\")\n\n  return (\n    <div className={styles.popup} ref={errorPopup}>\n      <strong className={styles.message}>{message}</strong>\n    </div>\n  )\n}\n\nexport default ErrPopup\n","import React from 'react'\nimport './Loader.css'\n\nconst Loader = () => <div className=\"lds-ring\"><div></div><div></div><div></div><div></div></div>\n\nexport default Loader\n","function Timer(fn, t) {\n  let timerObj = setTimeout(fn, t)\n\n  this.stop = function() {\n    if (timerObj) {\n      clearTimeout(timerObj)\n      timerObj = null\n    }\n    return this\n  }\n\n  this.start = function() {\n    if (!timerObj) {\n      this.stop()\n      timerObj = setTimeout(fn, t)\n    }\n    return this\n  }\n\n  this.reset = function(newT = t) {\n    t = newT\n    return this.stop().start()\n  }\n}\n\nexport default Timer\n","import { useRef, useEffect, useCallback } from 'react'\nimport { useDispatch } from 'react-redux'\nimport { useTypedSelector } from '../../utils/useTypedSelector'\nimport { fetchBooks, setOffset } from '../../store/actionCreators'\n// TypeScript (а именно его компилятор) запрещает явно указывать расширение ts/tsx файлов\n// @ts-ignore\nimport BookItem from '../BookItem/BookItem.tsx'\n// @ts-ignore\nimport Modal from '../Modal/Modal.tsx'\n// @ts-ignore\nimport ErrPopup from '../ErrPopup/ErrPopup.tsx'\nimport Loader from '../Loader/Loader'\nimport addInfScroll from '../../utils/infiniteScroll'\nimport Timer from '../../utils/timer'\nimport { bookInterface } from '../../store/types'\nimport styles from './App.module.scss'\n\nconst App: React.FC = () => {\n  const offset = useTypedSelector(state => state.offset)\n  const books = useTypedSelector(state => state.books)\n  const lastSearch = useTypedSelector(state => state.lastSearch)\n  const isLoading = useTypedSelector(state => state.showLoader)\n  const isError = useTypedSelector(state => state.error ?? false)\n  const notFoundMessage = useTypedSelector(state => state.booksNotFound)\n  const selectedBook = useTypedSelector(state => state.selectedBook)\n\n  const dispatch = useDispatch()\n\n  const searchInput = useRef<HTMLInputElement | null>(null)\n  const disclaimer = useRef<HTMLElement | null>(null)\n\n  const timer = new Timer(() => {\n    dispatch(fetchBooks(searchInput.current!.value))\n  }, 1000)\n  timer.stop()\n\n  const memoizedFetch = useCallback(() => {\n    if (offset !== 0 || searchInput.current!.value.trim() !== lastSearch) {\n      timer.reset()\n    }\n  }, [offset, lastSearch])\n\n  useEffect(() => {\n    document.removeEventListener('scroll', addInfScroll)\n    memoizedFetch()\n  }, [offset, memoizedFetch])\n\n  useEffect(() => {\n    if (books.length === 0) {\n      disclaimer.current!.classList.add(`${styles.show}`)\n    } \n  }, [books])\n\n  return (\n    <div className={styles.app}>\n      {isError && <ErrPopup />}\n      {selectedBook && <Modal />}\n      <h1 className={styles.title}>\n        Книги\n      </h1>\n      <div className={styles.search}>\n        <input\n          className={styles.search__input}\n          type=\"text\"\n          onChange={(e) => {\n            if (offset !== 0) dispatch(setOffset(0))\n            timer.reset()\n          }}\n          placeholder='Введите название книги'\n          ref={searchInput}\n        />\n        <button\n          className={styles.search__button}\n          onClick={() => {timer.stop(); dispatch(fetchBooks(searchInput.current!.value))}}\n        >\n          Найти\n        </button>\n      </div>\n\n      {books.length === 0 && <small id='disclaimer' className={styles.disclaimer} ref={disclaimer}>\n      Так как API не поддерживает русский язык, для поиска книги вводите её название транслитом, например <b>\"Ponedel'nik nachinaetsya v subbotu\"</b>\n      </small>}\n      \n      {isLoading && books.length === 0 && <Loader />}\n\n      {notFoundMessage\n        ? <p className={styles.noBooks}>К сожалению, по вашему запросу ничего найти не удалось</p>\n        : <div className='books'>\n            {books.map((book: bookInterface) => <BookItem book={book} key={book.key} />)}\n          </div>\n      }\n    </div>\n  )\n}\n\nexport default App\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport { Provider } from 'react-redux'\nimport store from './store/store'\nimport App from './components/App/App.tsx'\nimport './index.css'\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"App_app__3BT4Y\",\"title\":\"App_title__2C-7r\",\"search\":\"App_search__2Y1TS\",\"search__input\":\"App_search__input__8eVFo\",\"search__button\":\"App_search__button__1HI-h\",\"disclaimer\":\"App_disclaimer__2Szu9\",\"show\":\"App_show__3q8px\",\"noBooks\":\"App_noBooks__2fhmZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"book\":\"BookItem_book__1P0te\",\"book__cover\":\"BookItem_book__cover__YGfPK\",\"book__cover_placeholder\":\"BookItem_book__cover_placeholder__3RQcP\",\"book__info_title\":\"BookItem_book__info_title__1GSOz\",\"book__info_authors\":\"BookItem_book__info_authors__8_lfg\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"popup\":\"ErrPopup_popup__3Vo8r\",\"message\":\"ErrPopup_message__29wVz\",\"show\":\"ErrPopup_show__3KE3M\"};"],"sourceRoot":""}